// Generated by CoffeeScript 1.6.1
(function() {
  var Prlx;

  Prlx = (function() {
    var $document, $window, Actor, document_height, prefixed_elements, scroll_bottom, scroll_top, vendor_prefixes, window_height;

    $window = $(window);

    $document = $(document);

    vendor_prefixes = ["-webkit-", "-moz-", "-ms-", "-o-"];

    prefixed_elements = ["border-radius", "transform", "perspective", "perspective-origin", "box-shadow", "background-size"];

    document_height = $document.height();

    window_height = $window.height();

    scroll_top = $window.scrollTop();

    scroll_bottom = scroll_top + Prlx.window_height;

    function Prlx(el, options, fn) {
      var args, property, val,
        _this = this;
      this.el = el;
      this.el_top = this.el.offset().top;
      this.el_height = this.el.height();
      this.running = false;
      for (property in options) {
        val = options[property];
        args = val.match(/\S+/g);
        new Actor({
          el: this.el,
          property: property,
          limit: args[0],
          increment: args[1],
          trigger: args[2]
        });
      }
      $window.on('resize', function() {
        return window_height = $window.height();
      });
      $window.on('scroll', function(event) {
        _this.event = event;
        scroll_top = $window.scrollTop();
        scroll_bottom = scroll_top + window_height;
        if (!_this.running) {
          requestAnimationFrame(function() {
            var _ref;
            while ((_ref = _this.stack) != null ? _ref.length : void 0) {
              _this.stack.pop()();
            }
            return _this.running = false;
          });
        }
        return _this.running = true;
      });
    }

    Actor = (function() {
      var _this = this;

      Actor.actors || (Actor.actors = (function() {
        var actors;
        actors = [];
        return {
          get: function() {
            return actors;
          },
          add: function() {
            var n, _i, _len;
            for (_i = 0, _len = arguments.length; _i < _len; _i++) {
              n = arguments[_i];
              actors.push(n);
            }
            return actors;
          },
          pop: function() {
            return actors.pop();
          }
        };
      })());

      function Actor(options) {
        var actors;
        this.options = options;
        actors = Actor.actors;
        actors.add(this);
      }

      Actor.prototype.move = function() {
        var _this = this;
        return function() {
          return _this.el.css(_this.property, (_this.el.css(_this.property)) + _this.increment);
        };
      };

      return Actor;

    }).call(this);

    Prlx.prototype.positionOfElement = function() {
      return (this.el_top - scroll_top + this.el_height) / (scroll_bottom - scroll_top + this.el_height);
    };

    Prlx.prototype.isElFullyVisible = function() {
      var _ref;
      if (((scroll_bottom - this.el_height) > (_ref = this.el_top) && _ref > scroll_top)) {
        this.el.trigger('prlx:fullyVisible');
        return true;
      }
    };

    Prlx.prototype.isElPartiallyVisible = function() {
      var _ref;
      if ((scroll_bottom > (_ref = this.el_top) && _ref > (scroll_top - this.el_height))) {
        this.el.trigger('prlx:partiallyVisible');
        return true;
      }
    };

    Prlx.prototype.positionOfPageScrolled = function() {
      return scroll_top / (document_height - window_height);
    };

    Prlx.prototype.isFunction = function(obj) {
      return !!(obj && obj.constructor && obj.call && obj.apply);
    };

    Prlx.prototype.isObject = function(obj) {
      return obj === Object(obj);
    };

    return Prlx;

  }).call(this);

  (function($) {
    return $.fn.prlx = function(options, fn) {
      return $.each(this, function() {
        return new Prlx($(this), options);
      });
    };
  })(jQuery);

}).call(this);
